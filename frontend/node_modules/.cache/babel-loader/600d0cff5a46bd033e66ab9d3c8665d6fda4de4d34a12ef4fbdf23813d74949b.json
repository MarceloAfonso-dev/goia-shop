{"ast":null,"code":"import{useState,useEffect}from'react';export const useAuth=()=>{const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{// Verificar se há usuário logado no localStorage\nconst savedUser=localStorage.getItem('user');const token=localStorage.getItem('token');console.log('useAuth - verificando localStorage:',{savedUser:!!savedUser,token:!!token});if(savedUser&&token){try{const userData=JSON.parse(savedUser);console.log('useAuth - restaurando usuário:',userData);setUser(userData);}catch(e){console.error('Erro ao parsear dados do usuário:',e);localStorage.removeItem('user');localStorage.removeItem('token');}}setLoading(false);},[]);const login=userData=>{console.log('useAuth - fazendo login:',userData);setUser(userData);// Garantir que os dados sejam salvos no localStorage\nlocalStorage.setItem('user',JSON.stringify(userData));};const logout=()=>{console.log('useAuth - fazendo logout');setUser(null);localStorage.removeItem('token');localStorage.removeItem('user');};const isAuthenticated=()=>{const result=user!==null;console.log('useAuth - isAuthenticated:',result);return result;};const isAdmin=()=>{return(user===null||user===void 0?void 0:user.grupo)==='ADMIN';};const isEstoquista=()=>{return(user===null||user===void 0?void 0:user.grupo)==='ESTOQUISTA';};return{user,loading,login,logout,isAuthenticated,isAdmin,isEstoquista};};","map":{"version":3,"names":["useState","useEffect","useAuth","user","setUser","loading","setLoading","savedUser","localStorage","getItem","token","console","log","userData","JSON","parse","e","error","removeItem","login","setItem","stringify","logout","isAuthenticated","result","isAdmin","grupo","isEstoquista"],"sources":["D:/PI4/goia-shop/frontend/src/hooks/useAuth.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\n\r\nexport const useAuth = () => {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        // Verificar se há usuário logado no localStorage\r\n        const savedUser = localStorage.getItem('user');\r\n        const token = localStorage.getItem('token');\r\n        \r\n        console.log('useAuth - verificando localStorage:', { savedUser: !!savedUser, token: !!token });\r\n        \r\n        if (savedUser && token) {\r\n            try {\r\n                const userData = JSON.parse(savedUser);\r\n                console.log('useAuth - restaurando usuário:', userData);\r\n                setUser(userData);\r\n            } catch (e) {\r\n                console.error('Erro ao parsear dados do usuário:', e);\r\n                localStorage.removeItem('user');\r\n                localStorage.removeItem('token');\r\n            }\r\n        }\r\n        \r\n        setLoading(false);\r\n    }, []);\r\n\r\n    const login = (userData) => {\r\n        console.log('useAuth - fazendo login:', userData);\r\n        setUser(userData);\r\n        // Garantir que os dados sejam salvos no localStorage\r\n        localStorage.setItem('user', JSON.stringify(userData));\r\n    };\r\n\r\n    const logout = () => {\r\n        console.log('useAuth - fazendo logout');\r\n        setUser(null);\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('user');\r\n    };\r\n\r\n    const isAuthenticated = () => {\r\n        const result = user !== null;\r\n        console.log('useAuth - isAuthenticated:', result);\r\n        return result;\r\n    };\r\n\r\n    const isAdmin = () => {\r\n        return user?.grupo === 'ADMIN';\r\n    };\r\n\r\n    const isEstoquista = () => {\r\n        return user?.grupo === 'ESTOQUISTA';\r\n    };\r\n\r\n    return {\r\n        user,\r\n        loading,\r\n        login,\r\n        logout,\r\n        isAuthenticated,\r\n        isAdmin,\r\n        isEstoquista\r\n    };\r\n};\r\n"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAE3C,MAAO,MAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CACzB,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGJ,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACK,OAAO,CAAEC,UAAU,CAAC,CAAGN,QAAQ,CAAC,IAAI,CAAC,CAE5CC,SAAS,CAAC,IAAM,CACZ;AACA,KAAM,CAAAM,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAC9C,KAAM,CAAAC,KAAK,CAAGF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3CE,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAE,CAAEL,SAAS,CAAE,CAAC,CAACA,SAAS,CAAEG,KAAK,CAAE,CAAC,CAACA,KAAM,CAAC,CAAC,CAE9F,GAAIH,SAAS,EAAIG,KAAK,CAAE,CACpB,GAAI,CACA,KAAM,CAAAG,QAAQ,CAAGC,IAAI,CAACC,KAAK,CAACR,SAAS,CAAC,CACtCI,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAEC,QAAQ,CAAC,CACvDT,OAAO,CAACS,QAAQ,CAAC,CACrB,CAAE,MAAOG,CAAC,CAAE,CACRL,OAAO,CAACM,KAAK,CAAC,mCAAmC,CAAED,CAAC,CAAC,CACrDR,YAAY,CAACU,UAAU,CAAC,MAAM,CAAC,CAC/BV,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC,CACpC,CACJ,CAEAZ,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAa,KAAK,CAAIN,QAAQ,EAAK,CACxBF,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEC,QAAQ,CAAC,CACjDT,OAAO,CAACS,QAAQ,CAAC,CACjB;AACAL,YAAY,CAACY,OAAO,CAAC,MAAM,CAAEN,IAAI,CAACO,SAAS,CAACR,QAAQ,CAAC,CAAC,CAC1D,CAAC,CAED,KAAM,CAAAS,MAAM,CAAGA,CAAA,GAAM,CACjBX,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC,CACvCR,OAAO,CAAC,IAAI,CAAC,CACbI,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC,CAChCV,YAAY,CAACU,UAAU,CAAC,MAAM,CAAC,CACnC,CAAC,CAED,KAAM,CAAAK,eAAe,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAAC,MAAM,CAAGrB,IAAI,GAAK,IAAI,CAC5BQ,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAEY,MAAM,CAAC,CACjD,MAAO,CAAAA,MAAM,CACjB,CAAC,CAED,KAAM,CAAAC,OAAO,CAAGA,CAAA,GAAM,CAClB,MAAO,CAAAtB,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEuB,KAAK,IAAK,OAAO,CAClC,CAAC,CAED,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,CACvB,MAAO,CAAAxB,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEuB,KAAK,IAAK,YAAY,CACvC,CAAC,CAED,MAAO,CACHvB,IAAI,CACJE,OAAO,CACPc,KAAK,CACLG,MAAM,CACNC,eAAe,CACfE,OAAO,CACPE,YACJ,CAAC,CACL,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}